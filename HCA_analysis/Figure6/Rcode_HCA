#Codes for HCA in Figure 4 "Repeated SDS leads to the emergence of activity correlation between various brain regions"

#loading data

corcon<- read_csv("control_correlation_original.csv") # loading raw data of c-Fos/mm2 value of Control mice
corav<- read_csv("avoidant_correlation_original.csv") # loading raw data of c-Fos/mm2 values of SDS(Avoidant) mice

# Caluculating correlation values
cor(corcon [, -1])
cor(corav [, -1])

# Calculating the Euclidean distances for HCA
c_corcon.d<- dist(c_corcon)
c_corav.d<- dist(c_corav)

# HCA
c_corcon.hc<-hclust(c_corcon.d, method="ward.D") # HCA of regions from Control mice with Ward's method using "not"-squared Euclidean distances
c_corcon.hc2<-hclust(c_corcon.d, method="ward.D2") # HCA of regions from Control mice with Ward's method using squared Euclidean distances
c_corav.hc<-hclust(c_corav.d, method="ward.D") # HCA of regions from SDS mice with Ward's method using "not"-squared euclidean distances
c_corav.hc2<-hclust(c_corav.d, method="ward.D2") # HCA of regions from SDS mice with Ward's method using squared euclidean distances

# ploting dendograms and exporting the dendograms into jpg.file
jpeg("ward_dendorograms_correlation.jpg", width = 1000, height = 1000) # specifying .file type
par(mfrow=c(2,2)) # separating the drawing space into 2x2
plot(c_corcon.hc,hang=-1,main="Control_notSquared") # ploting dendorogram [Control, "not"-squared euclidean distances]
plot(c_corcon.hc2,hang=-1,main="Control_Squared") # ploting dendorogram [Control, squared euclidean distances]
plot(c_corav.hc,hang=-1,main="SDS_notSquared") # ploting dendorogram [SDS, "not"-squared euclidean distances]
plot(c_corav.hc2,hang=-1,main="SDS_squred") # ploting dendorogram [SDS, squared euclidean distances]
dev.off() # finish drawing

# not in code, checking the dendrogram and deciding the order of regions to visualize in Heatmap

c_corav.hc2$order # Extracting order of regions in dendrogram for the heatmap visualization
